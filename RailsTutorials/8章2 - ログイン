# ログイン
いよいよ有効な値の送信。ブラウザを閉じると自動的に有効期限が切れるタイプのcookiesを使った一時的なセッションでログインできるようにする。  
下準備としてApplicationコントローラ(app/controllers/application_controller.rb)でSessionヘルパーを読み込むために
```include SessionsHelper```を書く。



## ■log_inメソッド
1. 一時ユーザ情報を保存するコードをSessionヘルパー内に書いておく
一時ユーザID(ブラウザを閉じた瞬間に有効期限が切れる)をcookiesに保存しておくには```session[:user_id] = user.id```を書く  
Sessionヘルパー(app/helpers/sessions_helper.rb)に定義したメソッドの中でこれを書いておけば、このログイン手法を様々なページで使える。  
```
module SessionsHelper
  def log_in(user)
    session[:user_id] = user.id
  end
end
```
2. 定義したlog_inメソッドをSessionコントローラ内のcreateアクションに書く
ちなみに```redirect_to user```でuser_url(usr)へのリダイレクトとなる。  
最終的にこうなる  
```
  def create
    user = User.find_by(email: params[:session][:email].downcase)
    if user && user.authenticate(params[:session][:password])
      log_in user
      redirect_to user
    else
      flash.now[:danger] = 'Invalid email/password combination'
      render 'new'
    end
  end
```


### (今のうちからまとめを書いておく)
- APPlicationコントローラに```include SessionsHelper```を書く
- ```session[:user_id] = user.id```で一時ユーザ情報を保存できる。そしてそれをSessionsヘルパーに書いておく
